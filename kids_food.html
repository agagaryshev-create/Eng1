<script>
const allFoods = [
  "apple.png","apricot.png","banana.png","bread.png","cabbaga.png",
  "carrot.png","caviar.png","cheese.png","cherry.htm","dragon_fruit.png",
  "eggs.png","ginger.png","grapes.png","juice.png","lemon.png",
  "meat.png","melon.png","milk.png","onion.png","orange.png",
  "peach.png","pear.png","pineapple.png","potato.png","salad.png",
  "tomato.png","watermelon.png"
];

// Выбираем случайные 10
function getRandomFoods(arr, count){
  const copy = [...arr];
  const result = [];
  for(let i=0;i<count;i++){
    const idx = Math.floor(Math.random()*copy.length);
    result.push(copy.splice(idx,1)[0]);
  }
  return result;
}

const selectedFoods = getRandomFoods(allFoods, 10);

// Создаем вопросы
const questions = selectedFoods.map(file => {
  const word = file.replace(".png","").replace(".htm","").replace("_"," ");
  // Генерируем варианты ответов (случайные, включая правильный)
  const options = [word];
  while(options.length < 3){
    const randomFood = allFoods[Math.floor(Math.random()*allFoods.length)].replace(".png","").replace(".htm","").replace("_"," ");
    if(!options.includes(randomFood)) options.push(randomFood);
  }
  // Перемешиваем варианты
  options.sort(()=>Math.random()-0.5);
  return { word, img: "images/food/"+file, options };
});

let current = 0;
let score = 0;

function shuffle(arr){ return arr.sort(()=>Math.random()-0.5); }
shuffle(questions);

function loadQuestion() {
  const q = questions[current];
  document.getElementById("question").innerText = `Что это за еда? (${current+1}/${questions.length})`;
  document.getElementById("image").src = q.img;
  document.getElementById("image").alt = q.word;

  const optBox = document.getElementById("options");
  optBox.innerHTML = "";
  shuffle(q.options).forEach(opt => {
    const btn = document.createElement("button");
    btn.className = "option";
    btn.innerText = opt;
    btn.onclick = () => checkAnswer(btn,opt===q.word);
    optBox.appendChild(btn);
  });

  optBox.style.display = "flex";
  document.getElementById("image").style.display = "block";
  document.getElementById("question").style.display = "block";
  document.getElementById("result").innerText = "";
  document.getElementById("restart").style.display = "none";
}

function checkAnswer(selectedBtn, correct){
  const buttons = document.querySelectorAll("#options .option");
  buttons.forEach(btn=>{
    btn.disabled=true;
    if(btn.innerText===questions[current].word) btn.style.backgroundColor="#A5D6A7";
  });
  if(!correct) selectedBtn.style.backgroundColor="#EF9A9A"; else score++;

  current++;
  setTimeout(()=>{ if(current<questions.length) loadQuestion(); else showResult(); },1000);
}

function showResult(){
  document.getElementById("options").style.display="none";
  document.getElementById("image").style.display="none";
  document.getElementById("question").style.display="none";
  document.getElementById("result").innerText=`Ваш результат: ${score} из ${questions.length}`;
  document.getElementById("restart").style.display="block";
}

document.getElementById("restart").onclick=()=>{
  current=0; score=0; shuffle(questions); loadQuestion();
};

loadQuestion();
</script>
